Index: virtualbox-4.1.18-dfsg/src/recompiler/target-i386/op_helper.c
===================================================================
--- virtualbox-4.1.18-dfsg.orig/src/recompiler/target-i386/op_helper.c	2012-06-20 09:20:29.000000000 -0400
+++ virtualbox-4.1.18-dfsg/src/recompiler/target-i386/op_helper.c	2012-10-18 16:39:20.647324489 -0400
@@ -872,6 +872,13 @@
     type = (e2 >> DESC_TYPE_SHIFT) & 0x1f;
     switch(type) {
     case 5: /* task gate */
+#ifdef VBOX
+        dpl = (e2 >> DESC_DPL_SHIFT) & 3;
+        cpl = env->hflags & HF_CPL_MASK;
+        /* check privilege if software int */
+        if (is_int && dpl < cpl)
+            raise_exception_err(EXCP0D_GPF, intno * 8 + 2);
+#endif
         /* must do that check here to return the correct error code */
         if (!(e2 & DESC_P_MASK))
             raise_exception_err(EXCP0B_NOSEG, intno * 8 + 2);
