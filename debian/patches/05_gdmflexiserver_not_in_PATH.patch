Index: lightdm/src/session.c
===================================================================
--- lightdm.orig/src/session.c	2011-10-06 15:48:20.463657673 +1100
+++ lightdm/src/session.c	2011-10-06 15:49:55.635654379 +1100
@@ -211,6 +211,26 @@
     }
 }
 
+/* Insert our own utility directory to PATH
+ * This is to provide gdmflexiserver which provides backwards compatibility
+ * with GDM.
+ * Must be done after set_env_from_authentication because PAM sets PATH.
+ * This can be removed when this is no longer required.
+ */
+static void
+insert_utility_path (Session *session)
+{
+    const gchar *orig_path;
+
+    orig_path = session_get_env (session, "PATH");
+    if (orig_path)
+    {
+        gchar *path = g_strdup_printf ("%s:%s", PKGLIBEXEC_DIR, orig_path);
+        session_set_env (session, "PATH", path);
+        g_free (path);
+    }
+}
+
 gboolean
 session_start (Session *session)
 {
@@ -237,7 +257,6 @@
 {
     gboolean result;
     gchar *absolute_command;
-    const gchar *orig_path;
 
     absolute_command = get_absolute_command (session->priv->command);
     if (!absolute_command)
@@ -248,19 +267,6 @@
     process_set_command (PROCESS (session), absolute_command);
     g_free (absolute_command);
 
-    /* Insert our own utility directory to PATH
-     * This is to provide gdmflexiserver which provides backwards compatibility with GDM.
-     * Must be done after set_env_from_authentication because that often sets PATH.
-     * This can be removed when this is no longer required.
-     */
-    orig_path = session_get_env (session, "PATH");
-    if (orig_path)
-    {
-        gchar *path = g_strdup_printf ("%s:%s", PKGLIBEXEC_DIR, orig_path);
-        session_set_env (session, "PATH", path);
-        g_free (path);
-    }
-
     pam_session_open (session->priv->authentication);
 
     /* Open ConsoleKit session */
@@ -413,6 +419,7 @@
     pam_session_setup (session->priv->authentication);
     set_env_from_authentication (session, session->priv->authentication);
     set_locale (session);
+    insert_utility_path (session);
 
     PROCESS_CLASS (session_parent_class)->run (process);
 }
